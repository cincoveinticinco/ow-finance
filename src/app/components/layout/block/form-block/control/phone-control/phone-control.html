<div [formGroup]="form" class="form-group">
    <app-label labelBehavior [control]="control"></app-label>
    <div class="formgrid grid">
        @if (config.show_countries) {
            <div class="col-3 px-0">
                <p-select [options]="countries" optionLabel="name" [(ngModel)]="selectedCountry" [ngModelOptions]="{ standalone: true }" placeholder="Code" class="w-full md:w-56">
                    <ng-template #selectedItem let-selectedOption>
                        @if (selectedOption) {
                            <div class="flex items-center gap-2">
                                <img
                                    src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png"
                                    [class]="'flag flag-' + selectedOption.code.toLowerCase()"
                                    style="width: 23px"
                                />
                                <div>{{ selectedOption.name }}</div>
                            </div>
                        }
                    </ng-template>
                    <ng-template let-country #item>
                        <div class="flex items-center gap-2">
                            <img
                                src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png"
                                [class]="'flag flag-' + country.code.toLowerCase()"
                                style="width: 23px"
                            />
                            <div>{{ country.name }}</div>
                        </div>
                    </ng-template>
                    <ng-template #header>
                        <div class="font-medium p-3">Available Countries</div>
                    </ng-template>
                </p-select>
            </div>
        }
        <div class="px-0" [ngClass]="{'col-9': config.show_countries, 'col-12': !config.show_countries}">
            <p-inputmask [formControlName]="control.id!" [mask]="selectedCountry?.mask || defaultMask" [placeholder]="config.placeholder || defaultMask"  />
            <app-error-control [control]="control"></app-error-control>
            @if (config.helpText && (formContext.valid || !formContext.dirty)) {
                <small>{{ config.helpText }}</small>
            }
        </div>
    </div>
</div>